{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Resemblance Modeling\n",
    "\n",
    "Resemblance models try to measure how different two samples are from a multivariate perspective.\n",
    "\n",
    "It takes two datasets say X1 and X2 and labels them 0 and 1 respectively. Then it builds a model with that will try to \n",
    "predict, to which sample does an obeservation belong. When this model has an AUC=0.5, it means the samples are not distinguishable."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2019-08-26T08:58:34.812113Z",
     "start_time": "2019-08-26T08:58:33.945699Z"
    }
   },
   "outputs": [],
   "source": [
    "from probatus.datasets import lending_club\n",
    "from sklearn.model_selection import train_test_split\n",
    "\n",
    "import warnings\n",
    "warnings.simplefilter(action='ignore', category=FutureWarning)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Use the lending club dataset"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2019-08-26T08:58:34.857026Z",
     "start_time": "2019-08-26T08:58:34.813863Z"
    }
   },
   "outputs": [],
   "source": [
    "credit_df ,X_train,X_test,y_train, y_test =  lending_club()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2019-08-26T08:58:34.921487Z",
     "start_time": "2019-08-26T08:58:34.858386Z"
    }
   },
   "outputs": [],
   "source": [
    "from probatus.samples import ResemblanceModel"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Fit the model on two samples, in this case we want to compare how similar are train and test"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2019-08-26T08:58:35.021482Z",
     "start_time": "2019-08-26T08:58:34.922868Z"
    }
   },
   "outputs": [],
   "source": [
    "rm = ResemblanceModel().fit(X_train, X_test)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Check which features seem to have a higher importance in predicting to which sample does the model belong"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2019-08-26T08:58:35.026981Z",
     "start_time": "2019-08-26T08:58:35.023075Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "loan_amnt          0.164809\n",
       "funded_amnt        0.157083\n",
       "term               0.016384\n",
       "int_rate           0.200888\n",
       "annual_inc         0.229795\n",
       "fico_range_low     0.087594\n",
       "fico_range_high    0.087001\n",
       "long_emp           0.027253\n",
       "credit_grade_A     0.004839\n",
       "credit_grade_B     0.005030\n",
       "credit_grade_C     0.006968\n",
       "credit_grade_D     0.006018\n",
       "credit_grade_E     0.003534\n",
       "credit_grade_F     0.001741\n",
       "credit_grade_G     0.001062\n",
       "dtype: float64"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "rm.importances"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.1"
  },
  "latex_envs": {
   "LaTeX_envs_menu_present": true,
   "autoclose": false,
   "autocomplete": true,
   "bibliofile": "biblio.bib",
   "cite_by": "apalike",
   "current_citInitial": 1,
   "eqLabelWithNumbers": true,
   "eqNumInitial": 1,
   "hotkeys": {
    "equation": "Ctrl-E",
    "itemize": "Ctrl-I"
   },
   "labels_anchors": false,
   "latex_user_defs": false,
   "report_style_numbering": false,
   "user_envs_cfg": false
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
